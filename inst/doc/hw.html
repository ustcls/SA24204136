<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="SA24204136 S Liu" />

<meta name="date" content="2024-12-04" />

<title>hw</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">hw</h1>
<h4 class="author">SA24204136 S Liu</h4>
<h4 class="date">2024-12-04</h4>



<div id="homework-0" class="section level1">
<h1>Homework 0</h1>
<p>Use knitr to produce at least 3 examples. For each example,texts
should mix with figures and/or tables. Better to have mathematical
formulas.</p>
</div>
<div id="answer" class="section level1">
<h1>Answer</h1>
<div id="example-1" class="section level2">
<h2>Example 1:</h2>
Here are some characters of Univariate Gaussian distribution in the
table:
</div>
<div id="example-2" class="section level2">
<h2>Example 2:</h2>
<p>Here are some useful mathematical formulas about triangles in the
table:</p>
</div>
<div id="example-3" class="section level2">
<h2>Example 3:</h2>
<p>Body Mass Index(BMI) is a commonly used international standard for
measuring whether the degree of weight and height is healthy.the BMI
formula is <span class="math display">\[ BMI= \frac{W}{H^2} \]</span> W
is weight(kg) and H is height(m).The standard of BMI is in the
table.</p>
</div>
</div>
<div id="homework-1" class="section level1">
<h1>Homework 1</h1>
<p>Exercises 3.4, 3.11, and 3.20 (pages 94-96,Statistical Computating
with R)</p>
</div>
<div id="answer-1" class="section level1">
<h1>Answer</h1>
<div id="section" class="section level2">
<h2>3.4</h2>
<p><strong>Question:</strong>The Rayleigh density is <span class="math display">\[ f(x)=
\frac{x}{\sigma^2}e^{-\frac{x^2}{2\sigma^2}}\]</span> Develop an
algorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution. Generate
Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for
several choices of <span class="math inline">\(\sigma\)</span> &gt; 0
and check that the mode of the generated samples is close to the
theoretical mode <span class="math inline">\(\sigma\)</span> (check the
histogram).</p>
<p><strong>Answer:</strong>After observing the density function of
Rayleigh,We can find that the root mean square of two independent
Gaussian random variables is a Rayleigh distribution random variable.
The joint density function of two independent Gaussian random variables
is: <span class="math display">\[
f_{XY}(x,y)=\frac{1}{2\pi\sigma^2}exp{-\frac{x^2+y^2}{2\sigma^2}}
\]</span> Let <span class="math inline">\(x=rcos\theta\)</span>,<span class="math inline">\(y=rsin\theta\)</span>,and r is Rayleigh
variable,we can get: <span class="math display">\[ f(x)=
\frac{x}{\sigma^2}e^{-\frac{x^2}{2\sigma^2}}\]</span> So we can use two
independent Gaussian random variables to generate Rayleigh variable.</p>
<p>when <span class="math inline">\(\sigma\)</span>=1:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co">#set the value of sigma</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="at">sd=</span>sigma)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="at">sd=</span>sigma)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">sqrt</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>y<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>h<span class="ot">&lt;-</span><span class="fu">rweibull</span>(n,<span class="at">shape=</span><span class="dv">2</span>)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">hist</span>(r) <span class="co">#algorithm to generate random samples</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">hist</span>(h) <span class="co">#Rayleigh distribution</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAqFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkJBmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2///T09PbkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v///+Ug/5+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJiUlEQVR4nO2dC1vbNhiFzQYjo7tA6baWrruQbmOklxFI/P//2SzZThyIfD5ZJ4pLzvs869qQKCdvdLNsi6IUvRT7DjB2JAggQQAJAkgQQIIAEgSQIIAEASQIIEEACQJIEECCABIEkCCABAEkCCBBAAkCSBBAggASBJAggAQBJAggQQAJAkgQQIIAEgSQIEBY0PKqOLmr/3+6+kfnx3/9S46yfD8pih/GlmaooIfLr9iR5kXF+djSGAU9YVrQI82Ko+vxpYmrQR/OiuLo+xuXqMKF+vSqKL7+2X+dy/dFcXzts1al/35ZfHVTfrqsnveieqfFRXH66aw4el1+mFTPWr/NqgBfZFDR3tJECZoVRROljdQ84p5YPcWVebZ++ORuXv+4eqMqUs1Z+2HaL6otIFpQnjS9glqaSM77XfnRN826Ut9PmqTnvtGe3i2nbdKTm/K/6lXf3LknnftI5+61xevm+Z5uAaiJ7SdNjKDq9cf/ND+tIzVtf1p/je7v1VvXkd40T/z895kroHq8eu/6T5+xW0zZtoQYQZnSxAiqH6nbuC+krfeusPbvG6Uvf20LcN932fy5jtQtIFZQpjRRfdDDZd2I/2zeuX4HX5/ftH/vRnKf4fi3zxfBSN0CIkaxnGki50EP787aTszwndXvvQhHiqpB+0kTP1Fcvl238XCr96X7r2LVLW6JFNUH7SdNjKDqHX70Ndt39e714XGj/c5O7h6uwq0+ahTbT5qoGvR+NZHwM/G+mceq1fd2i92ZR3QNypMmrol9dG3+xU3ZTFRvmqnnL/ULqoe+u3kybhz/MaseCkXqFBDdxLKkoS93TB8faO+V9DQ8QVO/OlB9H1sOJvNDS8MT1Bzp9LWTjNDSEJvYw6tJc3Q9BlhptOQKkCCABAEkCCBBAAkCSBBAggASBJAggAQBJAggQQAJAkgQQIIAEgSQIIAEASQIIEEACQJIEECCABIEkCCABAEkCCBBAAkCSBCAI2h1FXzR/INSKo2UQOSP4gXd3o5NUEKgHQkaVyUaoaBxVaLDFdReGw5uyMwnCAbKK2jWXgI+D94MXKfKJQgHyipoebW+h6D3evFcggyBsgpaXLQ3Epbz3kaWS5AhkGoQCJS7D2q+sd4+qOoz8/VBKFDmUay9vRvVn9vh07K4F8JAY5wH5RRkKk6CQHEZRzHX0OdoophPkCFQfkF+uOiMr1sycQS1N42nBeIJMuZpkvQN87Qa5O5o7Z2xGwIxa5Apz/3E53k0L9tcnyI2sf5M5kC0JobzmL4wZh806+lhMtcgQ576Ju+2dwzmoQly/e+basIc+PTmQCxBIE8d6ei6ZyLNFOQ+fp2k58jPFogiyJQHsRY0VFFnFGPcrswcxXh5nKChgb7kiaIBqqBpVaHB0tysaDZzmmVY7jDkgTAFTX2DX1z0TM9mfn8094QMgnCe1VZt4ZGOKKidHPf0iPV6kB9Udi/IkKeKgrpvoqB2NSz00ct15uq73b0gQx73JHA4wmxi9WrY/STc6FcritPTDE0M5yndTKnnKLUkd9L3E7QZSKul3vkqHIjTSeM8mNzDfLvmGmz8z3qYZ/CcBRlP41oCUQQR85DmQYwdh5nzIF4e0jwobc7aDcSZB/HyUCeKw0rhL5gl5VkHK4kTRcbmbMyJIi8Ppw9Cc66IQJQ+iJiH1MT6D/tiApHOaoxsFKPwnOdBFJ61IL+D+ZSxQMURxMtD6qSPrmduK/2kRMxOmpeHth4061kKiwnEWg9i5aFNFF2ghHMsJXcU4+Wh1qBp0v7C/BrEyMPsg2Zp0zN6HzQsz5aLFzijGGkFjzaKfXEriqbiGkGjuJ9lzIJGMVcsXHMb6bFYoiBaHpaghrRRlV+D0vOQBZXTpGUYfhNLzrMSNKxPfPKiQV/ZthVFkqDkieJK0LA8T15EO9RgXaY4MkG9V3fYiqMKSs/DEmS6L8RUHHcUS87DbmJpjHkelENQzD2rz02Q4XKtuHtWWRPFpLkiswbVp1n6jp7j7jhMrUE4jwGioOVVnaTntpC4e1YTBRnyGGA2sZf1wgK8RtGz+xpkyGNgBzWobwUv6p5VUg1KXlHk9UF+bWrWu0IVc89qch9kyAOhDvP+0yf+xjvmME/Ko4liH4c+UbTkoTYxcKo3dqKYtixNysPspMGp3uhhPqkSsfLwhnl4qjc8USw2oAhKyrMOtiFoSJrOsRg81Wv5xjbspAgi5eEJspzqNUwUaYJIeXiCTKd68USRJoiUhyiIc6qXJ4h16pkniAFTUFKM9VkWZh/ESMbsgwC2zVaYo1g63FEMPsWy2Qqvk4YLL5abaImdtCGPZasMXg3CC8CGm2iJNQjmCW+2ss6TuZPGN9Hm7KTz1iAb8CbavIJcDUObrVAEcXrokibInMew2QpPEGOgZwqi5JEgkEeCQB4JQnmKrqABijiCAqtlYxB02xU0IM+zr0EsQYxLKUqiIF6eTUHRjex5Lnd082wKik4kQagEeiAJAoEkCATaFLTnW37GL2jPdUiCcB4JAnkkCOR5LCgy0AEKilN0gILiIrGvMMsryJInpyDDFV1PBe1wKmTKk1HQkOuDmtniThzZ8mQUZL3CbBsxmUaVh1yDspIlT2QfZPl9XvnIkSeu7nPuk+SRIc++1yNGD1tQzk56eJ6YAtiBHv/ZfWAPFJ3/Nv8RUQA7kATB8iQIlCdBoDwJAuVJEChPgkB5EgTKk6DDQYIAEgSQIIAEASQIIEEACQJIEECCABIEkCCABAGogubBnRLStmpLTBKOZYApyG3LNt8aZZ75XOxGknAsC0RB9bUE23YQ93tJ8d4oLkk4lgmioPoW9m0bIs1O3mYVtJEkHMsEU9C3rhpvucW/+kHePmgjSTCWDaKgup0/be2ujucVtJEkFMtIBkHpv8IoKcl4BAXqsn9YTawM9oaz5pIT0t4O0UnG00n3jad5a9BIh/m+GVnmmfQ4J4q+NY3kUKNJUm/nE45lQAerAAkCSBBAggASBJAggAQBJAggQQAJAkgQQIIAEgSQIIAEASQIIEEACQJIEECCABIEkCCABAEkCCBBAAkCSBDgUAQN/tUqEgSQIMDOBC1evkvbr5/L4uKnyaCr3HYn6GIsG515FhdH14N+N/sOBY1io7wWH6f5bW1R7FBQxqs2MT7OkEwSBJAggAQBJAggQYBDmUkPRoIAEgSQIIAEASQIIEEACQJIEECCABIEkCCABAEkCCBBAAkCSBBAggASBJAggAQBJAggQQAJAvwPhVwOzlVPA0MAAAAASUVORK5CYII=" /><!-- --></p>
<p>when <span class="math inline">\(\sigma\)</span>=2:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co">#set the value of sigma</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="at">sd=</span>sigma)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="at">sd=</span>sigma)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">sqrt</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>y<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>h<span class="ot">&lt;-</span><span class="fu">rweibull</span>(n,<span class="at">shape=</span><span class="dv">2</span>,<span class="at">scale=</span><span class="dv">2</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">hist</span>(r) <span class="co">#algorithm to generate random samples</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">hist</span>(h) <span class="co">#Rayleigh distribution</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>when <span class="math inline">\(\sigma\)</span>=3:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="dv">3</span> <span class="co">#set the value of sigma</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="at">sd=</span>sigma)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="at">sd=</span>sigma)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">sqrt</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>y<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>h<span class="ot">&lt;-</span><span class="fu">rweibull</span>(n,<span class="at">shape=</span><span class="dv">2</span>,<span class="at">scale=</span><span class="dv">3</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">hist</span>(r) <span class="co">#algorithm to generate random samples</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="fu">hist</span>(h) <span class="co">#Rayleigh distribution</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-1" class="section level2">
<h2>3.11</h2>
<p><strong>Question:</strong>Generate a random sample of size 1000 from
a normal location mixture.The components of the mixture have N(0,1) and
N(3,1) distributions with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2=1-p_1\)</span>.Graph the histogram of the
sample with density superimposed,for <span class="math inline">\(p_1=0.75\)</span>.Repeat with different values for
<span class="math inline">\(p_1\)</span> and observe whether the
empirical distribution of the mixture appears to be bimodal.Make a
conjecture about the values of <span class="math inline">\(p_1\)</span>
that produce bimodal mixtures.</p>
<p><strong>Answer:</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>p1<span class="ot">=</span><span class="fl">0.75</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>p2<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rnorm</span>(n)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">rnorm</span>(n,<span class="at">mean=</span><span class="dv">3</span>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>r<span class="ot">=</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(p2,p1))</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>z<span class="ot">=</span>r<span class="sc">*</span>x<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>y</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="fu">hist</span>(z)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>when <span class="math inline">\(p_1=0.75\)</span>,the empirical
distribution of the mixture don’t appears to be bimodal</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>p1<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>p2<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>r<span class="ot">=</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(p2,p1))</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>z<span class="ot">=</span>r<span class="sc">*</span>x<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>y</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="fu">hist</span>(z)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>when <span class="math inline">\(p_1=0.5\)</span>,the empirical
distribution of the mixture appears to be bimodal</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>p1<span class="ot">=</span><span class="fl">0.25</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>p2<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>r<span class="ot">=</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(p2,p1))</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>z<span class="ot">=</span>r<span class="sc">*</span>x<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>y</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">hist</span>(z)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>when <span class="math inline">\(p_1=0.25\)</span>,the empirical
distribution of the mixture don’t appears to be bimodal</p>
<p>We can guess that when <span class="math inline">\(p1\)</span> is
near to 0.5,the mixture appears to be bimodal.</p>
</div>
<div id="section-2" class="section level2">
<h2>3.20</h2>
<p><strong>Question:</strong>A compound Poisson process is a stochastic
process{<span class="math inline">\(X(t),t\geq0\)</span>} that can be
represented as the random sum<span class="math inline">\(X(t)=\sum_{i=1}^{N(t)}Y_i,t\geq0\)</span>,where{<span class="math inline">\(X(t),t\geq0\)</span>}is a Poisson process and
<span class="math inline">\(Y_1\)</span>,<span class="math inline">\(Y_2\)</span>,…are iid and independent of{<span class="math inline">\(X(t),t\geq0\)</span>}.Write a program to simulate
a compound Poisson(<span class="math inline">\(\lambda\)</span>)-Gamma
process(Y has a Gamma distribution).Estimate the mean and the variance
of X(10) for several choices of the parameters and compare with the
theoretical values.Hint:Show that <span class="math inline">\(E[X(t)]=\lambda tE[Y_1]\)</span> and <span class="math inline">\(Var(X(t))=\lambda tE[y_1^2]\)</span>.</p>
<p><strong>Answer:</strong></p>
<p>when r=1,<span class="math inline">\(\beta=1\)</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>r<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>beta<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>t<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>nt<span class="ot">=</span><span class="fu">rpois</span>(n,t)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>xt<span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>i<span class="ot">=</span>j<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nt[i]){</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>    xt[i]<span class="ot">=</span>xt[i]<span class="sc">+</span><span class="fu">rgamma</span>(<span class="dv">1</span>,r,beta)</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  }</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>}</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="fu">hist</span>(xt)  </span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>m1<span class="ot">=</span><span class="fu">mean</span>(xt)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>v1<span class="ot">=</span><span class="fu">var</span>(xt)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;the estimation of mean is &quot;</span>,m1,<span class="st">&quot;,the variance is &quot;</span>,v1,<span class="st">&quot;.the theoretical value of mean is 10,the variance is 20.&quot;</span>)</span></code></pre></div>
<pre><code>## the estimation of mean is  10.04144 ,the variance is  18.70217 .the theoretical value of mean is 10,the variance is 20.</code></pre>
<p>when r=2,<span class="math inline">\(\beta=2\)</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>r<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>beta<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>t<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>nt<span class="ot">=</span><span class="fu">rpois</span>(n,t)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>xt<span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>i<span class="ot">=</span>j<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nt[i]){</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>    xt[i]<span class="ot">=</span>xt[i]<span class="sc">+</span><span class="fu">rgamma</span>(<span class="dv">1</span>,r,beta)</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  }</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>}</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="fu">hist</span>(xt)  </span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>m2<span class="ot">=</span><span class="fu">mean</span>(xt)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>v2<span class="ot">=</span><span class="fu">var</span>(xt)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;the estimation of mean is &quot;</span>,m2,<span class="st">&quot;,the variance is &quot;</span>,v2,<span class="st">&quot;.the theoretical value of mean is 10,the variance is 15.&quot;</span>)</span></code></pre></div>
<pre><code>## the estimation of mean is  10.26125 ,the variance is  15.46704 .the theoretical value of mean is 10,the variance is 15.</code></pre>
<p>when r=4,<span class="math inline">\(\beta=2\)</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>r<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>beta<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>t<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>nt<span class="ot">=</span><span class="fu">rpois</span>(n,t)</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>xt<span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>i<span class="ot">=</span>j<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nt[i]){</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>    xt[i]<span class="ot">=</span>xt[i]<span class="sc">+</span><span class="fu">rgamma</span>(<span class="dv">1</span>,r,beta)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  }</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>}</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="fu">hist</span>(xt)  </span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>m3<span class="ot">=</span><span class="fu">mean</span>(xt)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>v3<span class="ot">=</span><span class="fu">var</span>(xt)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;the estimation of mean is &quot;</span>,m3,<span class="st">&quot;,the variance is &quot;</span>,v3,<span class="st">&quot;.the theoretical value of mean is 20,the variance is 50.&quot;</span>)</span></code></pre></div>
<pre><code>## the estimation of mean is  20.02295 ,the variance is  50.89379 .the theoretical value of mean is 20,the variance is 50.</code></pre>
</div>
</div>
<div id="homework-2" class="section level1">
<h1>Homework 2</h1>
<p>1.Exercises 5.4, 5.9, and 5.13 (pages 149-151, Statistical Computing
with R).</p>
<p>2.Monte Carlo experiment</p>
<ul>
<li><p>for n =<span class="math inline">\(10^4,2\times10^4,4\times10^4,6\times10^4,8\times10^4\)</span>,apply
the fast sorting algorithm to randomly permuted numbers of
1,…,n.</p></li>
<li><p>Calculate computation time averaged over 100 simulations,denoted
by <span class="math inline">\(a_n\)</span>.</p></li>
<li><p>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=nlog(n)\)</span>,and graphically show the
results(scatter plot and regression line)</p></li>
</ul>
</div>
<div id="answer-2" class="section level1">
<h1>Answer</h1>
<div id="section-3" class="section level2">
<h2>5.4</h2>
<p><strong>Question:</strong>Write a function to compute a Monte Carlo
estimate of the Beta(3,3) cdf,and use the function to estimate F(x) for
x=0.1,0.2,…,0.9.Compare the estimates with the values returned by the
pbeta function in R.</p>
<p><strong>Answer:</strong> the pdf of Beta(<span class="math inline">\(\alpha\)</span>,<span class="math inline">\(\beta\)</span>)is:</p>
<p><span class="math display">\[f(x)=\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}x^{\alpha-1}(1-x)^{\beta-1}
\]</span></p>
<p>When the distribution is Beta(3,3),the pdf of Beta(3,3) is</p>
<p><span class="math display">\[f(x)=\frac{\Gamma(6)}{\Gamma(3)\Gamma(3)}x^2(1-x)^2=30x^2(1-x)^2
\]</span></p>
<p>the cdf of Beta(3,3) is: <span class="math inline">\(F(x)=\int_0^x30t^2(1-t)^2dt\)</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>MC_beta_cdf<span class="ot">&lt;-</span><span class="cf">function</span>(x,n){</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  t<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span>x)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  theta_hat<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="dv">30</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>x</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="fu">return</span>(theta_hat)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>}</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>cb<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>){</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  cb[i]<span class="ot">&lt;-</span><span class="fu">MC_beta_cdf</span>(i<span class="sc">/</span><span class="dv">10</span>,<span class="dv">10000</span>)</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>}</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="fu">plot</span>(cb)</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>xb1<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span><span class="fl">0.1</span>),<span class="at">shape1=</span><span class="dv">3</span>,<span class="at">shape2=</span><span class="dv">3</span>)</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="fu">plot</span>(xb1)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>The Monte Carlo methods fits well.</p>
</div>
<div id="section-4" class="section level2">
<h2>5.9</h2>
<p><strong>Question:</strong>The Rayleigh density is <span class="math display">\[ f(x)=
\frac{x}{\sigma^2}e^{-\frac{x^2}{2\sigma^2}}\]</span> Implement a
function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution,using antithetic
variables.What is the percent reduction in variance of (X+X’)/2 compared
with (X1+X2)/2 for independent X1,X2?</p>
<p><strong>Answer:</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>MC.Phi <span class="ot">&lt;-</span> <span class="cf">function</span>(x,sigma, <span class="at">R =</span> <span class="dv">10000</span>, <span class="at">antithetic =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="cf">if</span> (antithetic) v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u <span class="cf">else</span> v <span class="ot">&lt;-</span> <span class="fu">runif</span>(R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(u, v)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  g <span class="ot">&lt;-</span> x<span class="sc">*</span>(u<span class="sc">*</span>x)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(u<span class="sc">*</span>x)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)) <span class="co"># x*u ~ N(0,x)</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  cdf <span class="ot">&lt;-</span> <span class="fu">mean</span>(g) <span class="sc">/</span> (sigma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  cdf</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>}</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> MC2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>  MC1[i] <span class="ot">&lt;-</span> <span class="fu">MC.Phi</span>(x,<span class="dv">1</span>, <span class="at">R =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>  MC2[i] <span class="ot">&lt;-</span> <span class="fu">MC.Phi</span>(x,<span class="dv">1</span>, <span class="at">R =</span> <span class="dv">1000</span>, <span class="at">antithetic =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>}</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">sd</span>(MC1),<span class="fu">sd</span>(MC2),<span class="fu">sd</span>(MC2)<span class="sc">/</span><span class="fu">sd</span>(MC1)),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.00569 0.00193 0.33939</code></pre>
<p>the antithetic variables is 33.559% of no antithetic variables.</p>
</div>
<div id="section-5" class="section level2">
<h2>5.13</h2>
<p><strong>Question:</strong>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on (1,<span class="math inline">\(\infty\)</span>) and ‘close’ to <span class="math inline">\(g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},x&gt;1\)</span>.
Which of your two importance functions should produce the smaller
variance in estimating <span class="math inline">\(\int_1^\infty
\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\)</span> by importance
sampling?Explain.</p>
<p><strong>Answer:</strong></p>
<p>when <span class="math inline">\(f_1(x)=\frac{1}{\sqrt{2\pi}}e^{-1/x^2}\)</span>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>(x<span class="sc">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>}</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>fg1<span class="ot">&lt;-</span><span class="fu">g</span>(x1)<span class="sc">/</span><span class="fu">dnorm</span>(x1)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>theta1<span class="ot">&lt;-</span><span class="fu">mean</span>(fg1)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>sd1<span class="ot">&lt;-</span><span class="fu">sd</span>(fg1)</span></code></pre></div>
<p>when<span class="math inline">\(f_2(x)=e^{-x}\)</span>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rexp</span>(n)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>fg2<span class="ot">&lt;-</span><span class="fu">g</span>(x2)<span class="sc">/</span><span class="fu">exp</span>(<span class="sc">-</span>x2)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>theta2<span class="ot">&lt;-</span><span class="fu">mean</span>(fg2)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>sd2<span class="ot">&lt;-</span><span class="fu">sd</span>(fg2)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">c</span>(theta1,theta2)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>sd<span class="ot">&lt;-</span><span class="fu">c</span>(sd1,sd2)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>res<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="at">theta=</span><span class="fu">round</span>(theta,<span class="dv">3</span>),<span class="at">sd=</span><span class="fu">round</span>(sd,<span class="dv">3</span>))</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>##        [,1]  [,2]
## theta 0.405 0.402
## sd    1.144 0.586</code></pre>
<p>Compare the sd of the two functions,we can find that <span class="math inline">\(f_2(x)\)</span> produce the smaller variance in
estimating g(x) by importance sampling.</p>
</div>
<div id="monte-carlo-experiment" class="section level2">
<h2>Monte Carlo experiment</h2>
<p><strong>Answer:</strong></p>
<p>fast sorting algorithm</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>fsa<span class="ot">&lt;-</span><span class="cf">function</span>(x){  <span class="co">#fast sorting algorithm function</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(x)<span class="sc">&lt;=</span><span class="dv">1</span>) {</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  }</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  p<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  l<span class="ot">&lt;-</span>x[x<span class="sc">&lt;</span>p]</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  r<span class="ot">&lt;-</span>x[x<span class="sc">&gt;</span>p]</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">fsa</span>(l),p,<span class="fu">c</span>(<span class="fu">fsa</span>(r))))</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>}</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fl">1e4</span>)</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fl">2e4</span>)</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>x3<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fl">4e4</span>)</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>x4<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fl">6e4</span>)</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>x5<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fl">8e4</span>)</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>t1<span class="ot">&lt;-</span>t2<span class="ot">&lt;-</span>t3<span class="ot">&lt;-</span>t4<span class="ot">&lt;-</span>t5<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>  t1[i]<span class="ot">&lt;-</span><span class="fu">system.time</span>({<span class="fu">fsa</span>(x1)})[<span class="dv">1</span>]</span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>  t2[i]<span class="ot">&lt;-</span><span class="fu">system.time</span>({<span class="fu">fsa</span>(x2)})[<span class="dv">1</span>]</span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>  t3[i]<span class="ot">&lt;-</span><span class="fu">system.time</span>({<span class="fu">fsa</span>(x3)})[<span class="dv">1</span>]</span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>  t4[i]<span class="ot">&lt;-</span><span class="fu">system.time</span>({<span class="fu">fsa</span>(x4)})[<span class="dv">1</span>]</span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>  t5[i]<span class="ot">&lt;-</span><span class="fu">system.time</span>({<span class="fu">fsa</span>(x5)})[<span class="dv">1</span>]</span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a>}</span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(t1),<span class="fu">mean</span>(t2),<span class="fu">mean</span>(t3),<span class="fu">mean</span>(t4),<span class="fu">mean</span>(t5))</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">1e4</span>,<span class="fl">2e4</span>,<span class="fl">4e4</span>,<span class="fl">6e4</span>,<span class="fl">8e4</span>)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>x0<span class="ot">&lt;-</span>n<span class="sc">*</span><span class="fu">log</span>(n)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">lm</span>(t<span class="sc">~</span>x0)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>r1<span class="ot">&lt;-</span>model<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>r2<span class="ot">&lt;-</span>model<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">plot</span>(n,t)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">lines</span>(n,r1<span class="sc">+</span>r2<span class="sc">*</span>n<span class="sc">*</span><span class="fu">log</span>(n))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>the plot shows that the regression fits well.</p>
</div>
</div>
<div id="homework-3" class="section level1">
<h1>Homework 3</h1>
<p>1.Exercise 6.6 and 6.B(page 180-181,Statistical Computing with R)</p>
<p>2.If we obtain the powers for two methods under a particular
simulation setting with 10,000 experiment:say,0.651 for one method and
0.676 for another method.We want to know if the powers are different at
0.05 level.</p>
<p>(1)What is the corresponding hypothesis test problem?</p>
<p>(2)What test should we use?Z-test,two-sample t-test,paired-t test or
McNemar test?Why?</p>
<p>(3)Please provide the least necessary information for hypothesis
testing.</p>
</div>
<div id="answer-3" class="section level1">
<h1>Answer</h1>
<div id="section-6" class="section level2">
<h2>6.6</h2>
<p><strong>Question:</strong> Estimate the 0.025,0.05,0.95,and 0.975
quantiles of the skewness <span class="math inline">\(\sqrt{b_1}\)</span> under normality by a Monte
Carlo experiment.Compute the standard error of the estimates from (2.14)
using the normal approximation for the density (with exact variance
formula).Compare the estimated quantiles with the quantiles of the large
sample approximation <span class="math inline">\(\sqrt{b_1}\approx
N(0,6/n)\)</span>.</p>
<p><strong>Answer:</strong></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>skewness<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  <span class="co">#compute the sample skewness statistics</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  xbar<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>  m1<span class="ot">&lt;-</span><span class="fu">mean</span>((x<span class="sc">-</span>xbar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>  m2<span class="ot">&lt;-</span><span class="fu">mean</span>((x<span class="sc">-</span>xbar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>  m3<span class="ot">&lt;-</span>m1<span class="sc">/</span>m2<span class="sc">^</span><span class="fl">1.5</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>  <span class="fu">return</span>(m3)</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>}</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>eq<span class="ot">&lt;-</span><span class="cf">function</span>(x,q){</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>  <span class="co">#estimate the quantiles</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>  t<span class="ot">&lt;-</span><span class="fu">quantile</span>(x,q)</span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>  <span class="fu">return</span>(t)</span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a>}</span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a>n<span class="ot">=</span><span class="fl">1e4</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e2</span></span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a>sk<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a>  sk[i]<span class="ot">&lt;-</span><span class="fu">skewness</span>(<span class="fu">rnorm</span>(m))</span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>q<span class="ot">&lt;-</span><span class="fu">eq</span>(sk,<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>))</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>varq<span class="ot">&lt;-</span><span class="cf">function</span>(q){</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="co">#compute the standard error</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>  f<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="sc">-</span>q<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>  r<span class="ot">&lt;-</span>q<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>q)<span class="sc">/</span>n<span class="sc">/</span>f<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>  <span class="fu">return</span>(r)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>}</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="fu">varq</span>(q)</span></code></pre></div>
<pre><code>##          2.5%            5%           95%         97.5% 
## -0.0005474696 -0.0004040686  0.0001721153  0.0001939267</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co">#compare the estimated quantiles with the quantiles of the large sample approximation sqrt(b_1) approx N(0,6/n)</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>com<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>m))</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>qcom<span class="ot">&lt;-</span><span class="fu">eq</span>(com,<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>))</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>result1<span class="ot">&lt;-</span><span class="cf">function</span>(q,qcom){</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>  <span class="co">#result reporting</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>  <span class="fu">print</span>(q)</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>  <span class="fu">print</span>(qcom)</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>}</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="fu">result1</span>(q,qcom)</span></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.4729704 -0.3946256  0.3835901  0.4645171 
##       2.5%         5%        95%      97.5% 
## -0.4755094 -0.4032506  0.4033278  0.4723740</code></pre>
<p>We can find that <span class="math inline">\(\sqrt{b_1}\)</span> is
asymptotically normal with mean 0 and variance 6/n.</p>
</div>
<div id="b" class="section level2">
<h2>6.B</h2>
<p><strong>Question:</strong>Tests for association based on Pearson
product moment correlation <span class="math inline">\(\rho\)</span>,Spearman’s rank correlation
coefficient <span class="math inline">\(\rho_s\)</span>,or Kendall’s
coefficient <span class="math inline">\(\tau\)</span>,are implemented in
cor.test.Show (empirically) that the nonparametric tests based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal.Find
an example of an alternative(a bivariate distribution(X,Y) such that X
and Y are dependent) such that at least one of the nonparametric tests
have better empirical power than the correlation test against this
alternative.</p>
<p><strong>Answer:</strong></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(<span class="dv">10000</span>,<span class="at">mu=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">Sigma=</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="fu">cor.test</span>(data[,<span class="dv">1</span>],data[,<span class="dv">2</span>],<span class="at">method=</span><span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>))</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  data[, 1] and data[, 2]
## t = -1.5649, df = 9998, p-value = 0.1176
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.035238329  0.003952215
## sample estimates:
##         cor 
## -0.01564907</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">cor.test</span>(data[,<span class="dv">1</span>],data[,<span class="dv">2</span>],<span class="at">method=</span><span class="fu">c</span>(<span class="st">&quot;spearman&quot;</span>))</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  data[, 1] and data[, 2]
## S = 1.6884e+11, p-value = 0.1923
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##         rho 
## -0.01304052</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">cor.test</span>(data[,<span class="dv">1</span>],data[,<span class="dv">2</span>],<span class="at">method=</span><span class="fu">c</span>(<span class="st">&quot;kendall&quot;</span>))</span></code></pre></div>
<pre><code>## 
##  Kendall&#39;s rank correlation tau
## 
## data:  data[, 1] and data[, 2]
## z = -1.302, p-value = 0.1929
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##          tau 
## -0.008681348</code></pre>
<p>A good test should have a power as large as possible,so the
nonparametric tests based on <span class="math inline">\(\rho_s\)</span>
or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rexp</span>(<span class="dv">1000</span>)</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a><span class="fu">cor.test</span>(x,y,<span class="at">method=</span><span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  x and y
## t = 0.806, df = 998, p-value = 0.4204
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.03654565  0.08736017
## sample estimates:
##        cor 
## 0.02550522</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">cor.test</span>(x,y,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  x and y
## S = 162715202, p-value = 0.4539
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##        rho 
## 0.02370781</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">cor.test</span>(x,y,<span class="at">method=</span><span class="st">&quot;kendall&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Kendall&#39;s rank correlation tau
## 
## data:  x and y
## z = 0.72482, p-value = 0.4686
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##        tau 
## 0.01530731</code></pre>
<p>When X~Exp(1) and Y~N(0,1),at least one of the nonparametric tests
have better empirical power than the correlation test against this
alternative.</p>
</div>
<div id="section-7" class="section level2">
<h2>2</h2>
<p>(1)Let the powers of the first and the second method are <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span>,so the corresponding hypothesis test
problem is: <span class="math display">\[H_0:p_1=p_2   &lt;-&gt;
H_1:p_1\neq p_2\]</span></p>
<p>(2)We can use paired-t test to solve this corresponding hypothesis
problem.Because the data of two methods are paired,and n=10000 is large
enough.</p>
<p>(3)The powers of the two methods are the least necessary information
for hypothesis testing.Because when we use paired-t test,we just care
about the difference between the two powers,and the specific value of
powers is unnecessary.</p>
</div>
</div>
<div id="homework-4" class="section level1">
<h1>Homework 4</h1>
<p>1.Of N=1000 hypotheses,950 are null and 50 are alternative.The
p-value under any null hypothesis is uniformly distributed(use
runif),and the p-value under any alternative hypothesis follows the beta
distribution with parameter 0.1 and 1(use rbeta).Obtain Bonferroni
adjusted p-values and B-H adjusted p-values.Calculate FWER,FDR,and TPR
under nominal level <span class="math inline">\(\alpha=0.1\)</span> for
each of the two adjustment methods based on m=10000 simulation
replicates.You should output the 6 numbers(3) to a 3*2 table(column
names:Bonferroni correction,B-H correction;row
names:FWER,FDR,TPR).Comment the results. 2.Exercise 7.4-7.5(pages
232,Statistical Computating with R)</p>
</div>
<div id="answer-4" class="section level1">
<h1>Answer</h1>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>fwerbon<span class="ot">&lt;-</span>fwerbh<span class="ot">&lt;-</span>fdrbon<span class="ot">&lt;-</span>fdrbh<span class="ot">&lt;-</span>tprbon<span class="ot">&lt;-</span>tprbh<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">10000</span>)</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>  p0<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">950</span>)</span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>  p1<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">50</span>,<span class="fl">0.1</span>,<span class="dv">1</span>)</span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>  p<span class="ot">&lt;-</span><span class="fu">sort</span>(<span class="fu">c</span>(p0,p1))</span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a>  p.adj1<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>  p.adj2<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&#39;BH&#39;</span>)</span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a>  fwer<span class="ot">&lt;-</span>fdr<span class="ot">&lt;-</span>tpr<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a>    <span class="cf">if</span>(p.adj1[i]<span class="sc">&lt;</span><span class="fl">0.1</span><span class="sc">/</span><span class="dv">1000</span>) {fwer[<span class="dv">1</span>]<span class="ot">&lt;-</span>fwer[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb42-11"><a href="#cb42-11" tabindex="-1"></a>    <span class="cf">if</span>(p.adj2[i]<span class="sc">&lt;</span><span class="fl">0.1</span><span class="sc">/</span><span class="dv">1000</span>) {fwer[<span class="dv">2</span>]<span class="ot">&lt;-</span>fwer[<span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb42-12"><a href="#cb42-12" tabindex="-1"></a>    <span class="cf">if</span>(p.adj1[i]<span class="sc">&lt;</span><span class="fl">0.1</span><span class="sc">*</span>i<span class="sc">/</span><span class="dv">1000</span>) {fdr[<span class="dv">1</span>]<span class="ot">&lt;-</span>fdr[<span class="dv">1</span>]<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb42-13"><a href="#cb42-13" tabindex="-1"></a>    <span class="cf">if</span>(p.adj2[i]<span class="sc">&lt;</span><span class="fl">0.1</span><span class="sc">*</span>i<span class="sc">/</span><span class="dv">1000</span>) {fdr[<span class="dv">2</span>]<span class="ot">&lt;-</span>fdr[<span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb42-14"><a href="#cb42-14" tabindex="-1"></a>  }</span>
<span id="cb42-15"><a href="#cb42-15" tabindex="-1"></a>  fwerbon[j]<span class="ot">&lt;-</span>fwer[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb42-16"><a href="#cb42-16" tabindex="-1"></a>  fwerbh[j]<span class="ot">&lt;-</span>fwer[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb42-17"><a href="#cb42-17" tabindex="-1"></a>  fdrbon[j]<span class="ot">&lt;-</span>fdr[<span class="dv">1</span>]<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb42-18"><a href="#cb42-18" tabindex="-1"></a>  fdrbh[j]<span class="ot">&lt;-</span>fdr[<span class="dv">2</span>]<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb42-19"><a href="#cb42-19" tabindex="-1"></a>  tprbon[j]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>fdrbon[j]</span>
<span id="cb42-20"><a href="#cb42-20" tabindex="-1"></a>  tprbh[j]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>fdrbh[j]</span>
<span id="cb42-21"><a href="#cb42-21" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(fwerbon),<span class="fu">mean</span>(fwerbh),<span class="fu">mean</span>(fdrbon),<span class="fu">mean</span>(fdrbh),<span class="fu">mean</span>(tprbon),<span class="fu">mean</span>(tprbh)),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="fu">colnames</span>(r)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&#39;bonferroni&#39;</span>,<span class="st">&#39;BH&#39;</span>)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a><span class="fu">rownames</span>(r)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&#39;FWER&#39;</span>,<span class="st">&#39;FDR&#39;</span>,<span class="st">&#39;TPR&#39;</span>)</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a><span class="fu">round</span>(r,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##      bonferroni     BH
## FWER      0.010 0.0130
## FDR       0.013 0.0179
## TPR       0.987 0.9821</code></pre>
<p>When using the Bonferroni adjusted p-values and B-H adjusted
p-values,the family wise error rate and false discovery rate are very
low and close,and the true discovery rate is very high.</p>
</div>
<div id="section-8" class="section level2">
<h2>7.4</h2>
<p><strong>Question:</strong>Refer to the air-conditioning data set
aircondit provided in the boot package.The 12 observations are the times
in hours between failures of air-conditioning equipment:
3,5,7,18,43,85,91,98,100,130,230,487. Assume that the times between
failures follow an exponential model EXP(<span class="math inline">\(\lambda\)</span>).Obtain the MLE of the hazard
rate <span class="math inline">\(\lambda\)</span> and use bootstrap to
estimate the bias and standard error of the estimate.</p>
<p><strong>Answer:</strong></p>
<p>The MLE of the hazard rate <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(1/\bar{X}\)</span></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="co"># compute the MLE of lambda_hat</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(lambda){</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">length</span>(x)<span class="sc">*</span><span class="fu">log</span>(lambda)<span class="sc">-</span>lambda<span class="sc">*</span><span class="fu">sum</span>(x))</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>}</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a><span class="fu">optimize</span>(f,<span class="at">interval=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">maximum =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## $maximum
## [1] 0.009245542
## 
## $objective
## [1] -68.19483</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co">#Bootstrap method</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>B<span class="ot">=</span><span class="fl">1e4</span></span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>lambdastar<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>lambda1<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>  xstar<span class="ot">&lt;-</span><span class="fu">sample</span>(x,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>  lambdastar[i]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>}</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias=</span><span class="fu">mean</span>(lambdastar)<span class="sc">-</span>lambda1,<span class="at">se.boot=</span><span class="fu">sd</span>(lambdastar)),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##    bias se.boot 
## 0.00132 0.00429</code></pre>
</div>
</div>
<div id="section-9" class="section level1">
<h1>7.5</h1>
<p><strong>Question:</strong>Refer to Exercise 7.4,Compute 95% bootstrap
confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard
normal,basic,percentile,and BCa methods.Compare the intervals and
explain why they may differ.</p>
<p><strong>Answer:</strong></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co">#basic method</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>fb<span class="ot">&lt;-</span><span class="cf">function</span>(x,i){<span class="fu">return</span>(<span class="fu">mean</span>(x[i]))}</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>bx<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>fb,<span class="at">R=</span><span class="dv">999</span>)</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>ci<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(bx,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>ci</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 999 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bx, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 30.7, 182.2 )   ( 22.7, 168.7 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.5, 193.5 )   ( 56.5, 231.8 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>The confidence intervals of Percentile method and BCa method is
bigger than the normal method and basic method.Different methods have
different estimation paths,so the confidence intervals are
different.</p>
</div>
<div id="question" class="section level1">
<h1>Question</h1>
<p>Exercises 7.8,7.10,8.1 and 8.2(pages 213 and 243,Statistical
Computing with R)</p>
</div>
<div id="answer-5" class="section level1">
<h1>Answer</h1>
<div id="section-10" class="section level2">
<h2>7.8</h2>
<p><strong>Question:</strong> Refer to Exercise 7.7,Obtain the jackknife
estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p><strong>Answer:</strong></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>data1<span class="ot">&lt;-</span>scor</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>dc<span class="ot">&lt;-</span><span class="fu">cov</span>(data1)</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="cf">function</span>(dc){</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>  <span class="co">#compute the theta</span></span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>  l<span class="ot">&lt;-</span><span class="fu">eigen</span>(dc,<span class="at">only.values =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>  theta<span class="ot">&lt;-</span>l[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(l)</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>  <span class="fu">return</span>(theta)</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>}</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">f1</span>(dc)</span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">dim</span>(data1)[<span class="dv">1</span>]</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>thetahat<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="cf">function</span>(data1){</span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>  <span class="co">#jackknife</span></span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a>    data2<span class="ot">&lt;-</span>data1[<span class="sc">-</span>i]</span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a>    c<span class="ot">&lt;-</span><span class="fu">cov</span>(data2)</span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a>    thetahat[i]<span class="ot">&lt;-</span><span class="fu">f1</span>(c)</span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>  }</span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a>  <span class="fu">return</span>(thetahat)</span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a>}</span>
<span id="cb52-12"><a href="#cb52-12" tabindex="-1"></a>thetahat<span class="ot">&lt;-</span><span class="fu">f2</span>(data1)</span>
<span id="cb52-13"><a href="#cb52-13" tabindex="-1"></a>bias.jack<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(thetahat)<span class="sc">-</span>theta)</span>
<span id="cb52-14"><a href="#cb52-14" tabindex="-1"></a>se.jack<span class="ot">&lt;-</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((thetahat<span class="sc">-</span>theta)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb52-15"><a href="#cb52-15" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" tabindex="-1"></a>f3<span class="ot">&lt;-</span><span class="cf">function</span>(theta,bias.jack,se.jack){</span>
<span id="cb52-18"><a href="#cb52-18" tabindex="-1"></a>  <span class="co">#show the result</span></span>
<span id="cb52-19"><a href="#cb52-19" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta,<span class="at">bias.jack=</span>bias.jack,<span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span>
<span id="cb52-20"><a href="#cb52-20" tabindex="-1"></a>}</span>
<span id="cb52-21"><a href="#cb52-21" tabindex="-1"></a><span class="fu">f3</span>(theta,bias.jack,se.jack)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.151     0.090</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="section-11" class="section level2">
<h2>7.10</h2>
<p><strong>Question:</strong> In Example 7.18,leave-one-out(n-fold)
cross validation was used to select the best fitting model.Repeat the
analysis replacing the Log-Log model with a cubic polynomial model.Which
of the four models is selected by the cross validation procedure?Which
model is selected according the maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
<p><strong>Answer:</strong></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>  e1[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>  </span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a>  J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a>  e2[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a>  </span>
<span id="cb58-18"><a href="#cb58-18" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb58-19"><a href="#cb58-19" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb58-20"><a href="#cb58-20" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb58-21"><a href="#cb58-21" tabindex="-1"></a>  e3[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb58-22"><a href="#cb58-22" tabindex="-1"></a>  </span>
<span id="cb58-23"><a href="#cb58-23" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb58-24"><a href="#cb58-24" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb58-25"><a href="#cb58-25" tabindex="-1"></a>  J4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">4</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb58-26"><a href="#cb58-26" tabindex="-1"></a>  e4[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat4</span>
<span id="cb58-27"><a href="#cb58-27" tabindex="-1"></a>}</span>
<span id="cb58-28"><a href="#cb58-28" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<p>According to the prediction error criterion,Model 2,the quadratic
model,would be the best fit for the data.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="fu">summary</span>(J1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.5784 -2.3022 -0.0203  2.1964 11.9740 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.7881     2.5077   0.713    0.479    
## x             0.8895     0.1159   7.678 5.25e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.188 on 50 degrees of freedom
## Multiple R-squared:  0.5411, Adjusted R-squared:  0.5319 
## F-statistic: 58.95 on 1 and 50 DF,  p-value: 5.249e-10</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="fu">summary</span>(J2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.2243 -2.4454 -0.1374  2.2346 12.5821 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) 25.98525    8.75932   2.967  0.00464 **
## x           -1.52948    0.85065  -1.798  0.07834 . 
## I(x^2)       0.05707    0.01991   2.867  0.00609 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.915 on 49 degrees of freedom
## Multiple R-squared:  0.607,  Adjusted R-squared:  0.591 
## F-statistic: 37.84 on 2 and 49 DF,  p-value: 1.154e-10</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">summary</span>(J3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(y) ~ x)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.63621 -0.08603 -0.00391  0.10665  0.44188 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.127402   0.115186  18.469  &lt; 2e-16 ***
## x           0.040570   0.005321   7.624 6.37e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1924 on 50 degrees of freedom
## Multiple R-squared:  0.5376, Adjusted R-squared:  0.5283 
## F-statistic: 58.13 on 1 and 50 DF,  p-value: 6.371e-10</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">summary</span>(J4)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2) + I(x^3))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.4347 -2.0627 -0.3247  2.2127 13.1177 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -2.763718  26.402670  -0.105    0.917
## x            2.908468   3.938834   0.738    0.464
## I(x^2)      -0.160916   0.189976  -0.847    0.401
## I(x^3)       0.003424   0.002968   1.154    0.254
## 
## Residual standard error: 3.902 on 48 degrees of freedom
## Multiple R-squared:  0.6176, Adjusted R-squared:  0.5937 
## F-statistic: 25.84 on 3 and 48 DF,  p-value: 4.264e-10</code></pre>
<p>Model 4 is selected according the maximum adjusted <span class="math inline">\(R^2\)</span>.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="section-12" class="section level2">
<h2>8.1</h2>
<p><strong>Question:</strong> Implement the two-sample Cramer-von Mises
test for equal distributions as a permutation test.Apply the test to the
data in Example 8.1 and 8.2. <strong>Answer:</strong></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">library</span>(twosamples) <span class="co">#call the function cvm_test</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co">#number of replicates</span></span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) <span class="co">#pooled sample</span></span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">26</span></span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a>D0 <span class="ot">&lt;-</span> <span class="fu">cvm_test</span>(x, y)[<span class="dv">2</span>]</span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a>cvm<span class="ot">&lt;-</span><span class="cf">function</span>(){</span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a>  D<span class="ot">&lt;-</span><span class="fu">numeric</span>(R)</span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a>    <span class="co">#generate indices k for the first sample</span></span>
<span id="cb70-12"><a href="#cb70-12" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb70-13"><a href="#cb70-13" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb70-14"><a href="#cb70-14" tabindex="-1"></a>    y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] </span>
<span id="cb70-15"><a href="#cb70-15" tabindex="-1"></a>    D[i] <span class="ot">&lt;-</span> <span class="fu">cvm_test</span>(x1, y1)[<span class="dv">2</span>]</span>
<span id="cb70-16"><a href="#cb70-16" tabindex="-1"></a>  }</span>
<span id="cb70-17"><a href="#cb70-17" tabindex="-1"></a>  <span class="fu">return</span>(D)</span>
<span id="cb70-18"><a href="#cb70-18" tabindex="-1"></a>}</span>
<span id="cb70-19"><a href="#cb70-19" tabindex="-1"></a>D<span class="ot">&lt;-</span><span class="fu">cvm</span>()</span>
<span id="cb70-20"><a href="#cb70-20" tabindex="-1"></a>cp<span class="ot">&lt;-</span><span class="cf">function</span>(D0,D){</span>
<span id="cb70-21"><a href="#cb70-21" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(D0, D) <span class="sc">&gt;=</span> D0)</span>
<span id="cb70-22"><a href="#cb70-22" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb70-23"><a href="#cb70-23" tabindex="-1"></a>}</span>
<span id="cb70-24"><a href="#cb70-24" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">cp</span>(D0,D)</span>
<span id="cb70-25"><a href="#cb70-25" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="dv">0</span>)</span>
<span id="cb70-26"><a href="#cb70-26" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.584</code></pre>
<p>When using the two-sample Cramer-von Mises test,the approximate ASL
does not support the alternative hypothesis that distributions
differ.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="section-13" class="section level2">
<h2>8.2</h2>
<p><strong>Question:</strong> Implement the bivariate Spearman rank
correlation test for independence as a permutation test.The Spearman
rank correlation test statistic can be obtained from function cor with
method=“spearman”.Compare the achieved significance level of the
permutation test with the p-value reported by cor.test on the same
samples.</p>
<p><strong>Answer:</strong></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>]))</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">999</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">c</span>(x,y)</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>K<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">24</span></span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>D0<span class="ot">&lt;-</span><span class="fu">cor</span>(x,y,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a>spearman<span class="ot">&lt;-</span><span class="cf">function</span>(){</span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a>  D<span class="ot">&lt;-</span><span class="fu">numeric</span>(R)</span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb74-10"><a href="#cb74-10" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb74-11"><a href="#cb74-11" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb74-12"><a href="#cb74-12" tabindex="-1"></a>    y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] </span>
<span id="cb74-13"><a href="#cb74-13" tabindex="-1"></a>    D[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x1,y1,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb74-14"><a href="#cb74-14" tabindex="-1"></a>  }</span>
<span id="cb74-15"><a href="#cb74-15" tabindex="-1"></a>  <span class="fu">return</span>(D)</span>
<span id="cb74-16"><a href="#cb74-16" tabindex="-1"></a>}</span>
<span id="cb74-17"><a href="#cb74-17" tabindex="-1"></a>D<span class="ot">&lt;-</span><span class="fu">spearman</span>()</span>
<span id="cb74-18"><a href="#cb74-18" tabindex="-1"></a></span>
<span id="cb74-19"><a href="#cb74-19" tabindex="-1"></a>sp<span class="ot">&lt;-</span><span class="cf">function</span>(D0,D){</span>
<span id="cb74-20"><a href="#cb74-20" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(D0, D) <span class="sc">&gt;=</span> D0)</span>
<span id="cb74-21"><a href="#cb74-21" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb74-22"><a href="#cb74-22" tabindex="-1"></a>}</span>
<span id="cb74-23"><a href="#cb74-23" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">sp</span>(D0,D)</span>
<span id="cb74-24"><a href="#cb74-24" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="dv">0</span>)</span>
<span id="cb74-25"><a href="#cb74-25" tabindex="-1"></a></span>
<span id="cb74-26"><a href="#cb74-26" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="cf">function</span>(p){</span>
<span id="cb74-27"><a href="#cb74-27" tabindex="-1"></a>  <span class="cf">if</span>(p<span class="sc">&lt;=</span><span class="fl">0.05</span>){<span class="fu">print</span>(<span class="st">&quot;reject the null hypothesis&quot;</span>)}</span>
<span id="cb74-28"><a href="#cb74-28" tabindex="-1"></a>  <span class="cf">else</span> {<span class="fu">print</span>(<span class="st">&quot;accept the null hypothesis&quot;</span>)}</span>
<span id="cb74-29"><a href="#cb74-29" tabindex="-1"></a>}</span>
<span id="cb74-30"><a href="#cb74-30" tabindex="-1"></a><span class="fu">r</span>(p)</span></code></pre></div>
<pre><code>## [1] &quot;reject the null hypothesis&quot;</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>cp<span class="ot">&lt;-</span><span class="fu">cor.test</span>(x,y)[<span class="dv">3</span>]</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a><span class="fu">r</span>(cp)</span></code></pre></div>
<pre><code>## [1] &quot;reject the null hypothesis&quot;</code></pre>
<p>The result of the two test is the same:reject the null
hypothesis.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="question-2" class="section level1">
<h1>Question:</h1>
<p>1.Exercies 9.3 and 9.8 (pages 277-278, Statistical Computing with R).
2.For each of the above exercise, use the Gelman-Rubin method to monitor
convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\hat{R}\)</span> &lt; 1.2.</p>
</div>
<div id="answer-6" class="section level1">
<h1>Answer:</h1>
<div id="section-14" class="section level2">
<h2>9.3</h2>
<p><strong>Question:</strong></p>
<p>Use the Metropolis-Hastings sampler to generate random variables from
a standard Cauchy distribution. Discard the first 1000 of the chain, and
compare the deciles of the generated observations with the deciles of
the standard Cauchy distribution (see qcauchy or qt with df=1). Recall
that a Cauchy(θ, η) distribution has density function <span class="math display">\[f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)}\]</span>
The standard Cauchy has the Cauchy(θ = 1, η = 0) density. (Note that the
standard Cauchy density is equal to the Student t density with one
degree of freedom.)</p>
<p><strong>Answer:</strong></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>fc<span class="ot">&lt;-</span><span class="cf">function</span>(x,eta,theta){</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span>(theta<span class="sc">*</span>pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>((x<span class="sc">-</span>eta)<span class="sc">/</span>theta)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>}</span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>MH<span class="ot">&lt;-</span><span class="cf">function</span>(){</span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>  eta<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a>  theta<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb79-11"><a href="#cb79-11" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(m)</span>
<span id="cb79-12"><a href="#cb79-12" tabindex="-1"></a>  </span>
<span id="cb79-13"><a href="#cb79-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m){</span>
<span id="cb79-14"><a href="#cb79-14" tabindex="-1"></a>    xt<span class="ot">&lt;-</span>x[i<span class="dv">-1</span>]</span>
<span id="cb79-15"><a href="#cb79-15" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,xt)</span>
<span id="cb79-16"><a href="#cb79-16" tabindex="-1"></a>    num<span class="ot">&lt;-</span><span class="fu">fc</span>(y,eta,theta)<span class="sc">*</span><span class="fu">dnorm</span>(xt,y)</span>
<span id="cb79-17"><a href="#cb79-17" tabindex="-1"></a>    den<span class="ot">&lt;-</span><span class="fu">fc</span>(xt,eta,theta)<span class="sc">*</span><span class="fu">dnorm</span>(y,xt)</span>
<span id="cb79-18"><a href="#cb79-18" tabindex="-1"></a>    <span class="cf">if</span>(u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den){</span>
<span id="cb79-19"><a href="#cb79-19" tabindex="-1"></a>      x[i]<span class="ot">&lt;-</span>y</span>
<span id="cb79-20"><a href="#cb79-20" tabindex="-1"></a>    }</span>
<span id="cb79-21"><a href="#cb79-21" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb79-22"><a href="#cb79-22" tabindex="-1"></a>      x[i]<span class="ot">&lt;-</span>xt</span>
<span id="cb79-23"><a href="#cb79-23" tabindex="-1"></a>    }</span>
<span id="cb79-24"><a href="#cb79-24" tabindex="-1"></a>  }</span>
<span id="cb79-25"><a href="#cb79-25" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb79-26"><a href="#cb79-26" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a>q<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>)<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">MH</span>()[<span class="dv">1001</span><span class="sc">:</span><span class="dv">10000</span>]</span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>nc<span class="ot">&lt;-</span><span class="fu">rcauchy</span>(<span class="dv">9000</span>)</span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>m1<span class="ot">&lt;-</span><span class="fu">quantile</span>(x,q,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>m2<span class="ot">&lt;-</span><span class="fu">quantile</span>(nc,q)</span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="cf">function</span>(m1,m2){</span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;the deciles of the generated observations is &quot;</span>)</span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a>  <span class="fu">print</span>(m1)</span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;the deciles of the standard Cauchy distribution is &quot;</span>)</span>
<span id="cb80-11"><a href="#cb80-11" tabindex="-1"></a>  <span class="fu">print</span>(m2)</span>
<span id="cb80-12"><a href="#cb80-12" tabindex="-1"></a>}</span>
<span id="cb80-13"><a href="#cb80-13" tabindex="-1"></a><span class="fu">r</span>(m1,m2)</span></code></pre></div>
<pre><code>## [1] &quot;the deciles of the generated observations is &quot;
##        10%        20%        30%        40%        50%        60%        70% 
## -1.9069266 -0.9475918 -0.4812827 -0.1280205  0.1787377  0.5518450  1.0631548 
##        80%        90% 
##  1.9663760  5.3215236 
## [1] &quot;the deciles of the standard Cauchy distribution is &quot;
##        10%        20%        30%        40%        50%        60%        70% 
## -2.8809623 -1.3264050 -0.6917426 -0.2940965  0.0279795  0.3568793  0.7625503 
##        80%        90% 
##  1.4132234  3.0834378</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb82-8"><a href="#cb82-8" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb82-9"><a href="#cb82-9" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb82-10"><a href="#cb82-10" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb82-11"><a href="#cb82-11" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb82-12"><a href="#cb82-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">9000</span></span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a>    X[i, ] <span class="ot">&lt;-</span> <span class="fu">MH</span>()[<span class="dv">1001</span><span class="sc">:</span><span class="dv">10000</span>]</span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a>  }</span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a>  </span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a><span class="co">#Compute the diagnostic statistics</span></span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb83-12"><a href="#cb83-12" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)){</span>
<span id="cb83-13"><a href="#cb83-13" tabindex="-1"></a>    psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb83-14"><a href="#cb83-14" tabindex="-1"></a>  }</span>
<span id="cb83-15"><a href="#cb83-15" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">Gelman.Rubin</span>(psi)<span class="sc">&lt;</span><span class="fl">1.2</span>) <span class="cf">break</span></span>
<span id="cb83-16"><a href="#cb83-16" tabindex="-1"></a>}</span>
<span id="cb83-17"><a href="#cb83-17" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">Gelman.Rubin</span>(psi),k))</span></code></pre></div>
<pre><code>## [1] 1.036273 3.000000</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="section-15" class="section level2">
<h2>9.8</h2>
<p><strong>Question:</strong></p>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[f(x,y)\propto C_n^x
y^{x+a-1}(1-y)^{n-x+b-1},x=0,1,...,n,0 \leq y \leq 1\]</span> It can be
shown (see e.g. [23]) that for fixed a, b, n, the conditional
distributions are Binomial(n, y) and Beta(x + a, n − x + b). Use the
Gibbs sampler to generate a chain with target joint density f(x, y).</p>
<p><strong>Answer:</strong></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a>N<span class="ot">=</span><span class="dv">5000</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>burn<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>a<span class="ot">=</span>b<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a>Gibbs<span class="ot">&lt;-</span><span class="cf">function</span>(){</span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a>  </span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="dv">50</span></span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a>  X[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(x,y)</span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a>  </span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a>    x2<span class="ot">&lt;-</span>X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb86-14"><a href="#cb86-14" tabindex="-1"></a>    X[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">100</span>,x2)</span>
<span id="cb86-15"><a href="#cb86-15" tabindex="-1"></a>    x1<span class="ot">&lt;-</span>X[i<span class="dv">-1</span>,<span class="dv">1</span>]</span>
<span id="cb86-16"><a href="#cb86-16" tabindex="-1"></a>    X[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x1<span class="sc">+</span>a,n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb86-17"><a href="#cb86-17" tabindex="-1"></a>  }</span>
<span id="cb86-18"><a href="#cb86-18" tabindex="-1"></a>  b<span class="ot">&lt;-</span>burn<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb86-19"><a href="#cb86-19" tabindex="-1"></a>  x<span class="ot">&lt;-</span>X[b<span class="sc">:</span>N,] </span>
<span id="cb86-20"><a href="#cb86-20" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb86-21"><a href="#cb86-21" tabindex="-1"></a>}</span>
<span id="cb86-22"><a href="#cb86-22" tabindex="-1"></a></span>
<span id="cb86-23"><a href="#cb86-23" tabindex="-1"></a>fcom<span class="ot">&lt;-</span><span class="cf">function</span>(x,n){</span>
<span id="cb86-24"><a href="#cb86-24" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">factorial</span>(x)<span class="sc">*</span><span class="fu">factorial</span>(n<span class="sc">-</span>x)<span class="sc">/</span><span class="fu">factorial</span>(n))</span>
<span id="cb86-25"><a href="#cb86-25" tabindex="-1"></a>}</span>
<span id="cb86-26"><a href="#cb86-26" tabindex="-1"></a></span>
<span id="cb86-27"><a href="#cb86-27" tabindex="-1"></a>fd<span class="ot">&lt;-</span><span class="cf">function</span>(x,y){</span>
<span id="cb86-28"><a href="#cb86-28" tabindex="-1"></a>  <span class="co">#density f(x,y)</span></span>
<span id="cb86-29"><a href="#cb86-29" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">fcom</span>(x,n)<span class="sc">*</span>(y<span class="sc">^</span>(x<span class="sc">+</span>a<span class="dv">-1</span>))<span class="sc">*</span>((<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">^</span>(n<span class="sc">-</span>x<span class="sc">+</span>b<span class="dv">-1</span>)))</span>
<span id="cb86-30"><a href="#cb86-30" tabindex="-1"></a>}</span>
<span id="cb86-31"><a href="#cb86-31" tabindex="-1"></a></span>
<span id="cb86-32"><a href="#cb86-32" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">Gibbs</span>()</span>
<span id="cb86-33"><a href="#cb86-33" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">fd</span>(x[,<span class="dv">1</span>],x[,<span class="dv">2</span>])</span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb87-10"><a href="#cb87-10" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb87-11"><a href="#cb87-11" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb87-12"><a href="#cb87-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">4000</span></span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb88-8"><a href="#cb88-8" tabindex="-1"></a>    X1[i, ] <span class="ot">&lt;-</span> <span class="fu">Gibbs</span>()[,<span class="dv">1</span>]</span>
<span id="cb88-9"><a href="#cb88-9" tabindex="-1"></a>    X2[i, ] <span class="ot">&lt;-</span> <span class="fu">Gibbs</span>()[,<span class="dv">2</span>]</span>
<span id="cb88-10"><a href="#cb88-10" tabindex="-1"></a>  }</span>
<span id="cb88-11"><a href="#cb88-11" tabindex="-1"></a>  </span>
<span id="cb88-12"><a href="#cb88-12" tabindex="-1"></a><span class="co">#Compute the diagnostic statistics</span></span>
<span id="cb88-13"><a href="#cb88-13" tabindex="-1"></a>  psi1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X1, <span class="dv">1</span>, cumsum))</span>
<span id="cb88-14"><a href="#cb88-14" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi1)){</span>
<span id="cb88-15"><a href="#cb88-15" tabindex="-1"></a>    psi1[i,] <span class="ot">&lt;-</span> psi1[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi1))</span>
<span id="cb88-16"><a href="#cb88-16" tabindex="-1"></a>  }</span>
<span id="cb88-17"><a href="#cb88-17" tabindex="-1"></a>  psi2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X2, <span class="dv">1</span>, cumsum))</span>
<span id="cb88-18"><a href="#cb88-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi2)){</span>
<span id="cb88-19"><a href="#cb88-19" tabindex="-1"></a>    psi2[i,] <span class="ot">&lt;-</span> psi2[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi2))</span>
<span id="cb88-20"><a href="#cb88-20" tabindex="-1"></a>  }</span>
<span id="cb88-21"><a href="#cb88-21" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">Gelman.Rubin</span>(psi1)<span class="sc">&lt;</span><span class="fl">1.2</span><span class="sc">&amp;</span><span class="fu">Gelman.Rubin</span>(psi2)<span class="sc">&lt;</span><span class="fl">1.2</span>) <span class="cf">break</span></span>
<span id="cb88-22"><a href="#cb88-22" tabindex="-1"></a>}</span>
<span id="cb88-23"><a href="#cb88-23" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">Gelman.Rubin</span>(psi1),<span class="fu">Gelman.Rubin</span>(psi2)<span class="sc">&lt;</span><span class="fl">1.2</span>,k))</span></code></pre></div>
<pre><code>## [1]  1.227668  0.000000 10.000000</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="homework-7" class="section level1">
<h1>Homework 7</h1>
<p>1.Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with
R)</p>
<p>2.Suppose <span class="math inline">\(T_1,...,T_n\)</span> are i.i.d.
samples drawn fron the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right
censorship,so that the observed values are <span class="math inline">\(Y_i=T_iI(T_i\leq \tau)+\tau I(T_i &gt;
\tau)\)</span>, i=1,…,n. Suppose <span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows:
0.54,0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85 Use the E-M algorithm
to estimate <span class="math inline">\(\lambda\)</span>,compare your
result with the observed data MLE(note:<span class="math inline">\(Y_i\)</span> follows a mixture distribution).</p>
</div>
<div id="answer-7" class="section level1">
<h1>Answer</h1>
<div id="section-16" class="section level2">
<h2>11.3</h2>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a>an<span class="ot">&lt;-</span><span class="cf">function</span>(a){</span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a>  <span class="co">#Euclidean norm</span></span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a>}</span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a>lf<span class="ot">&lt;-</span><span class="cf">function</span>(n){</span>
<span id="cb91-7"><a href="#cb91-7" tabindex="-1"></a>  <span class="co">#log factorial function</span></span>
<span id="cb91-8"><a href="#cb91-8" tabindex="-1"></a>  <span class="cf">if</span>(n<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb91-9"><a href="#cb91-9" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb91-10"><a href="#cb91-10" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb91-11"><a href="#cb91-11" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">log</span>(n)<span class="sc">+</span><span class="fu">lf</span>(n<span class="dv">-1</span>))</span>
<span id="cb91-12"><a href="#cb91-12" tabindex="-1"></a>  }</span>
<span id="cb91-13"><a href="#cb91-13" tabindex="-1"></a>}</span>
<span id="cb91-14"><a href="#cb91-14" tabindex="-1"></a></span>
<span id="cb91-15"><a href="#cb91-15" tabindex="-1"></a>kt<span class="ot">&lt;-</span><span class="cf">function</span>(a,k,d){</span>
<span id="cb91-16"><a href="#cb91-16" tabindex="-1"></a>  <span class="co">#k_th term</span></span>
<span id="cb91-17"><a href="#cb91-17" tabindex="-1"></a>  lterm<span class="ot">&lt;-</span><span class="fu">log</span>(<span class="fu">an</span>(a))<span class="sc">+</span><span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lf</span>(k)<span class="sc">-</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb91-18"><a href="#cb91-18" tabindex="-1"></a>  <span class="fu">return</span>((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">*</span><span class="fu">exp</span>(lterm))</span>
<span id="cb91-19"><a href="#cb91-19" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a>fsum<span class="ot">&lt;-</span><span class="cf">function</span>(a,k,d){</span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>  f<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>k){</span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a>    f<span class="ot">&lt;-</span>f<span class="sc">+</span><span class="fu">kt</span>(a,i,d)</span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a>  }</span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a>  <span class="fu">return</span>(f)</span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a>}</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">2000</span></span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a><span class="fu">fsum</span>(a,k,d)</span></code></pre></div>
<pre><code>## [1] 0.8274602</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="section-17" class="section level2">
<h2>11.5</h2>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a>ck<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>}</span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(a){</span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a>  <span class="fu">pt</span>(<span class="fu">ck</span>(a,k),<span class="at">df=</span>k)<span class="sc">-</span><span class="fu">pt</span>(<span class="fu">ck</span>(a,k<span class="dv">-1</span>),<span class="at">df=</span>k<span class="dv">-1</span>)</span>
<span id="cb96-7"><a href="#cb96-7" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a>fa<span class="ot">&lt;-</span><span class="cf">function</span>(k){</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a>  res<span class="ot">&lt;-</span><span class="fu">uniroot</span>(f,<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fu">sqrt</span>(k)<span class="sc">-</span><span class="fl">0.1</span>))</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a>  <span class="fu">return</span>(res<span class="sc">$</span>root)</span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a>}</span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a></span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">22</span>)</span>
<span id="cb97-7"><a href="#cb97-7" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>){</span>
<span id="cb97-8"><a href="#cb97-8" tabindex="-1"></a>  a[k<span class="dv">-3</span>]<span class="ot">&lt;-</span><span class="fu">fa</span>(k)</span>
<span id="cb97-9"><a href="#cb97-9" tabindex="-1"></a>}</span>
<span id="cb97-10"><a href="#cb97-10" tabindex="-1"></a><span class="fu">names</span>(a)<span class="ot">&lt;-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">25</span></span>
<span id="cb97-11"><a href="#cb97-11" tabindex="-1"></a><span class="fu">print</span>(a)</span></code></pre></div>
<pre><code>##        4        5        6        7        8        9       10       11 
## 1.492103 1.533582 1.562744 1.584429 1.601183 1.614536 1.625366 1.634415 
##       12       13       14       15       16       17       18       19 
## 1.642017 1.648547 1.654170 1.659098 1.663444 1.667283 1.670738 1.673795 
##       20       21       22       23       24       25 
## 1.676614 1.679154 1.681472 1.683594 1.685569 1.687336</code></pre>
<p>a is equal to the solutions with the point A(k).</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="section-18" class="section level2">
<h2>2</h2>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a>T0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">1.00</span>,<span class="fl">1.00</span>,<span class="fl">0.91</span>,<span class="fl">1.00</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>)</span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a>MLE<span class="ot">&lt;-</span><span class="cf">function</span>(T0){</span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">length</span>(T0)<span class="sc">/</span><span class="fu">sum</span>(T0))</span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a>}</span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a>lambda0<span class="ot">&lt;-</span>lambda<span class="ot">&lt;-</span><span class="fu">MLE</span>(T0)</span>
<span id="cb100-8"><a href="#cb100-8" tabindex="-1"></a>that<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>lambda</span>
<span id="cb100-9"><a href="#cb100-9" tabindex="-1"></a>T0[T0<span class="sc">==</span><span class="fl">1.00</span>]<span class="ot">&lt;-</span>that</span>
<span id="cb100-10"><a href="#cb100-10" tabindex="-1"></a></span>
<span id="cb100-11"><a href="#cb100-11" tabindex="-1"></a></span>
<span id="cb100-12"><a href="#cb100-12" tabindex="-1"></a>N<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb100-13"><a href="#cb100-13" tabindex="-1"></a>tol<span class="ot">&lt;-</span>.Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.5</span></span>
<span id="cb100-14"><a href="#cb100-14" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb100-15"><a href="#cb100-15" tabindex="-1"></a>  t<span class="ot">&lt;-</span>lambda</span>
<span id="cb100-16"><a href="#cb100-16" tabindex="-1"></a>  lambda<span class="ot">&lt;-</span><span class="fu">MLE</span>(T0)</span>
<span id="cb100-17"><a href="#cb100-17" tabindex="-1"></a>  that<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>lambda</span>
<span id="cb100-18"><a href="#cb100-18" tabindex="-1"></a>  T0[T0<span class="sc">==</span>t]<span class="ot">&lt;-</span>that</span>
<span id="cb100-19"><a href="#cb100-19" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">abs</span>(lambda<span class="sc">-</span>t)<span class="sc">/</span>t<span class="sc">&lt;</span>tol) <span class="cf">break</span></span>
<span id="cb100-20"><a href="#cb100-20" tabindex="-1"></a>}</span>
<span id="cb100-21"><a href="#cb100-21" tabindex="-1"></a></span>
<span id="cb100-22"><a href="#cb100-22" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">MLE=</span>lambda0,<span class="at">EM=</span>lambda),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##    MLE     EM 
## 1.4815 1.1396</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="homework-8" class="section level1">
<h1>Homework 8</h1>
<p>1.Exercises 11.7 (page 354, Statistical Computing with R)</p>
<p>2.Exercises 3, 4, 5 (page 204, Advanced R)</p>
<p>3.Excecises 3 and 6 (page 213-214, Advanced R)</p>
<p>4.Excecise4 4-5 (page 365, Advanced R)</p>
</div>
<div id="answer-8" class="section level1">
<h1>Answer</h1>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a>A1<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a>b1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">9</span>)</span>
<span id="cb103-5"><a href="#cb103-5" tabindex="-1"></a><span class="fu">simplex</span>(<span class="at">a=</span>a,<span class="at">A1=</span>A1,<span class="at">b1=</span>b1,<span class="at">maxi=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
## Linear Programming Results
## 
## Call : simplex(a = a, A1 = A1, b1 = b1, maxi = FALSE)
## 
## Minimization Problem with Objective Function Coefficients
## x1 x2 x3 
##  4  2  9 
## 
## 
## Optimal solution has the following values
## x1 x2 x3 
##  0  0  0 
## The optimal value of the objective  function is 0.</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>p204 3</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>    mpg <span class="sc">~</span> disp,</span>
<span id="cb106-3"><a href="#cb106-3" tabindex="-1"></a>    mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb106-4"><a href="#cb106-4" tabindex="-1"></a>    mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb106-5"><a href="#cb106-5" tabindex="-1"></a>    mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb106-6"><a href="#cb106-6" tabindex="-1"></a>)</span>
<span id="cb106-7"><a href="#cb106-7" tabindex="-1"></a></span>
<span id="cb106-8"><a href="#cb106-8" tabindex="-1"></a>mod1<span class="ot">&lt;-</span><span class="fu">lapply</span>(formulas,<span class="cf">function</span>(x){<span class="fu">lm</span>(x,<span class="at">data=</span>mtcars)})</span></code></pre></div>
<p>p204 4</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>})</span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a></span>
<span id="cb107-6"><a href="#cb107-6" tabindex="-1"></a>formulas<span class="ot">&lt;-</span><span class="fu">list</span>(y<span class="sc">~</span>x)</span>
<span id="cb107-7"><a href="#cb107-7" tabindex="-1"></a>mod2<span class="ot">&lt;-</span><span class="fu">list</span>()  <span class="co">#save the result</span></span>
<span id="cb107-8"><a href="#cb107-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)){</span>
<span id="cb107-9"><a href="#cb107-9" tabindex="-1"></a>  y<span class="ot">&lt;-</span>bootstraps[[i]]<span class="sc">$</span>mpg</span>
<span id="cb107-10"><a href="#cb107-10" tabindex="-1"></a>  x<span class="ot">&lt;-</span>bootstraps[[i]]<span class="sc">$</span>disp</span>
<span id="cb107-11"><a href="#cb107-11" tabindex="-1"></a>  mod2<span class="ot">&lt;-</span><span class="fu">append</span>(mod2,<span class="fu">lapply</span>(formulas,lm))</span>
<span id="cb107-12"><a href="#cb107-12" tabindex="-1"></a>}</span></code></pre></div>
<p>p204 5</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>rsq1<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a>rsq2<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a></span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a>  rsq1[i]<span class="ot">&lt;-</span><span class="fu">rsq</span>(mod1[[i]])</span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a>}</span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a>  rsq2[i]<span class="ot">&lt;-</span><span class="fu">rsq</span>(mod2[[i]])</span>
<span id="cb108-12"><a href="#cb108-12" tabindex="-1"></a>}</span>
<span id="cb108-13"><a href="#cb108-13" tabindex="-1"></a></span>
<span id="cb108-14"><a href="#cb108-14" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">rsq1=</span>rsq1),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## rsq11 rsq12 rsq13 rsq14 
## 0.718 0.860 0.781 0.884</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">rsq2=</span>rsq2),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  rsq21  rsq22  rsq23  rsq24  rsq25  rsq26  rsq27  rsq28  rsq29 rsq210 
##  0.716  0.603  0.718  0.656  0.744  0.785  0.794  0.812  0.628  0.823</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>p213 3</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a>)</span>
<span id="cb113-6"><a href="#cb113-6" tabindex="-1"></a></span>
<span id="cb113-7"><a href="#cb113-7" tabindex="-1"></a>pv1<span class="ot">&lt;-</span><span class="fu">sapply</span>(trials,<span class="cf">function</span>(x) x<span class="sc">$</span>p.value)</span>
<span id="cb113-8"><a href="#cb113-8" tabindex="-1"></a></span>
<span id="cb113-9"><a href="#cb113-9" tabindex="-1"></a>pv2<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb113-10"><a href="#cb113-10" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb113-11"><a href="#cb113-11" tabindex="-1"></a>  pv2[i]<span class="ot">&lt;-</span>trials[[i]]<span class="sc">$</span>p.value</span>
<span id="cb113-12"><a href="#cb113-12" tabindex="-1"></a>}</span>
<span id="cb113-13"><a href="#cb113-13" tabindex="-1"></a><span class="fu">round</span>(pv1,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   [1] 0.214 0.943 0.489 0.247 0.736 0.179 0.096 0.209 0.464 0.315 0.417 0.721
##  [13] 0.981 0.472 0.963 0.184 0.487 0.075 0.806 0.343 0.747 0.634 0.994 0.160
##  [25] 0.806 0.461 0.967 0.731 0.027 0.575 0.604 0.286 0.866 0.940 0.762 0.470
##  [37] 0.602 0.934 0.608 0.468 0.360 0.141 0.233 0.604 0.756 0.049 0.954 0.447
##  [49] 0.404 0.121 0.452 0.744 0.293 0.101 0.796 0.488 0.461 0.667 0.808 0.876
##  [61] 0.081 0.581 0.905 0.918 0.333 0.871 0.307 0.579 0.904 0.575 0.719 0.059
##  [73] 0.041 0.322 0.491 0.444 0.234 0.035 0.605 0.198 0.297 0.900 0.581 0.543
##  [85] 0.957 0.355 0.189 0.011 0.825 0.413 0.602 0.915 0.603 0.297 0.672 0.833
##  [97] 0.747 0.008 0.926 0.180</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="fu">round</span>(pv2,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   [1] 0.214 0.943 0.489 0.247 0.736 0.179 0.096 0.209 0.464 0.315 0.417 0.721
##  [13] 0.981 0.472 0.963 0.184 0.487 0.075 0.806 0.343 0.747 0.634 0.994 0.160
##  [25] 0.806 0.461 0.967 0.731 0.027 0.575 0.604 0.286 0.866 0.940 0.762 0.470
##  [37] 0.602 0.934 0.608 0.468 0.360 0.141 0.233 0.604 0.756 0.049 0.954 0.447
##  [49] 0.404 0.121 0.452 0.744 0.293 0.101 0.796 0.488 0.461 0.667 0.808 0.876
##  [61] 0.081 0.581 0.905 0.918 0.333 0.871 0.307 0.579 0.904 0.575 0.719 0.059
##  [73] 0.041 0.322 0.491 0.444 0.234 0.035 0.605 0.198 0.297 0.900 0.581 0.543
##  [85] 0.957 0.355 0.189 0.011 0.825 0.413 0.602 0.915 0.603 0.297 0.672 0.833
##  [97] 0.747 0.008 0.926 0.180</code></pre>
<p>p214 6</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a>lapply1<span class="ot">&lt;-</span><span class="cf">function</span>(x,fun,fun.value){</span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a>  rv<span class="ot">&lt;-</span><span class="fu">vapply</span>(x,<span class="at">FUN =</span> fun,<span class="at">FUN.VALUE =</span> fun.value)</span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a>  <span class="fu">Map</span>(as.matrix,rv)</span>
<span id="cb117-4"><a href="#cb117-4" tabindex="-1"></a>}</span>
<span id="cb117-5"><a href="#cb117-5" tabindex="-1"></a></span>
<span id="cb117-6"><a href="#cb117-6" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="at">x1=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="at">x2=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>)))</span>
<span id="cb117-7"><a href="#cb117-7" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">lapply1</span>(x,mean,<span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb117-8"><a href="#cb117-8" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## $x1
##      [,1]
## [1,]  2.5
## 
## $x2
##      [,1]
## [1,]  6.5</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<p>p365 4</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a>fastchisq.test<span class="ot">&lt;-</span><span class="cf">function</span>(x,y){</span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.numeric</span>(x)<span class="sc">&amp;&amp;</span><span class="fu">is.numeric</span>(y)){</span>
<span id="cb120-3"><a href="#cb120-3" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">is.na</span>(x)<span class="sc">|</span><span class="fu">is.na</span>(y))) <span class="fu">print</span>(<span class="st">&quot;the vectors have missing values&quot;</span>)</span>
<span id="cb120-4"><a href="#cb120-4" tabindex="-1"></a>    <span class="cf">else</span> <span class="fu">return</span>(<span class="fu">chisq.test</span>(x,y))</span>
<span id="cb120-5"><a href="#cb120-5" tabindex="-1"></a>  }</span>
<span id="cb120-6"><a href="#cb120-6" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">print</span>(<span class="st">&quot;not numeric vectors&quot;</span>)</span>
<span id="cb120-7"><a href="#cb120-7" tabindex="-1"></a>}</span>
<span id="cb120-8"><a href="#cb120-8" tabindex="-1"></a></span>
<span id="cb120-9"><a href="#cb120-9" tabindex="-1"></a><span class="co">#example</span></span>
<span id="cb120-10"><a href="#cb120-10" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb120-11"><a href="#cb120-11" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb120-12"><a href="#cb120-12" tabindex="-1"></a><span class="fu">fastchisq.test</span>(x,y)</span></code></pre></div>
<pre><code>## Warning in chisq.test(x, y): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  x and y
## X-squared = 0, df = 1, p-value = 1</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="cn">NA</span>)</span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a><span class="fu">fastchisq.test</span>(x,y)</span></code></pre></div>
<pre><code>## [1] &quot;the vectors have missing values&quot;</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="st">&quot;a&quot;</span>)</span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a><span class="fu">fastchisq.test</span>(x,y)</span></code></pre></div>
<pre><code>## [1] &quot;not numeric vectors&quot;</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>p365 5</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a>ftable<span class="ot">&lt;-</span><span class="cf">function</span>(x,y){</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.integer</span>(x)<span class="sc">||!</span><span class="fu">is.integer</span>(y)<span class="sc">||</span><span class="fu">any</span>(<span class="fu">is.na</span>(x)<span class="sc">|</span><span class="fu">is.na</span>(y))){</span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;error&quot;</span>)</span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a>    <span class="fu">table</span>(x,y)</span>
<span id="cb128-6"><a href="#cb128-6" tabindex="-1"></a>  }</span>
<span id="cb128-7"><a href="#cb128-7" tabindex="-1"></a>}</span>
<span id="cb128-8"><a href="#cb128-8" tabindex="-1"></a></span>
<span id="cb128-9"><a href="#cb128-9" tabindex="-1"></a><span class="co">#example</span></span>
<span id="cb128-10"><a href="#cb128-10" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb128-11"><a href="#cb128-11" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb128-12"><a href="#cb128-12" tabindex="-1"></a><span class="fu">ftable</span>(x,y)</span></code></pre></div>
<pre><code>##    y
## x   1 2 3
##   1 0 0 1
##   2 1 0 0
##   3 0 1 0</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="fl">0.2</span>)</span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a><span class="fu">ftable</span>(x,y)</span></code></pre></div>
<pre><code>## [1] &quot;error&quot;</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="question-3" class="section level1">
<h1>Question</h1>
<p>Write an Rcpp function for Exercise 9.8 (page 278, Statistical
Computing with R).</p>
<p>Compare the corresponding generated random numbers with those by the
R function you wrote using the function “qqplot”.</p>
<p>Compare the computation time of the two functions with the function
“microbenchmark”.</p>
<p>Comments your results.</p>
</div>
<div id="answer-9" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a>dir_cpp<span class="ot">&lt;-</span><span class="st">&#39;D:/a/&#39;</span></span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="fu">paste0</span>(dir_cpp,<span class="st">&quot;Gibbs.cpp&quot;</span>))</span>
<span id="cb133-4"><a href="#cb133-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb133-5"><a href="#cb133-5" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb133-6"><a href="#cb133-6" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb133-7"><a href="#cb133-7" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb133-8"><a href="#cb133-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb133-9"><a href="#cb133-9" tabindex="-1"></a></span>
<span id="cb133-10"><a href="#cb133-10" tabindex="-1"></a></span>
<span id="cb133-11"><a href="#cb133-11" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">Gibbs</span>(N, burn, n, a, b)</span>
<span id="cb133-12"><a href="#cb133-12" tabindex="-1"></a>result<span class="ot">&lt;-</span>result[<span class="dv">1001</span><span class="sc">:</span><span class="dv">5000</span>,]</span>
<span id="cb133-13"><a href="#cb133-13" tabindex="-1"></a></span>
<span id="cb133-14"><a href="#cb133-14" tabindex="-1"></a>fcom<span class="ot">&lt;-</span><span class="cf">function</span>(x,n){</span>
<span id="cb133-15"><a href="#cb133-15" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">factorial</span>(x)<span class="sc">*</span><span class="fu">factorial</span>(n<span class="sc">-</span>x)<span class="sc">/</span><span class="fu">factorial</span>(n))</span>
<span id="cb133-16"><a href="#cb133-16" tabindex="-1"></a>}</span>
<span id="cb133-17"><a href="#cb133-17" tabindex="-1"></a></span>
<span id="cb133-18"><a href="#cb133-18" tabindex="-1"></a>fd<span class="ot">&lt;-</span><span class="cf">function</span>(x,y){</span>
<span id="cb133-19"><a href="#cb133-19" tabindex="-1"></a>  <span class="co">#density f(x,y)</span></span>
<span id="cb133-20"><a href="#cb133-20" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">fcom</span>(x,n)<span class="sc">*</span>(y<span class="sc">^</span>(x<span class="sc">+</span>a<span class="dv">-1</span>))<span class="sc">*</span>((<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">^</span>(n<span class="sc">-</span>x<span class="sc">+</span>b<span class="dv">-1</span>)))</span>
<span id="cb133-21"><a href="#cb133-21" tabindex="-1"></a>}</span>
<span id="cb133-22"><a href="#cb133-22" tabindex="-1"></a></span>
<span id="cb133-23"><a href="#cb133-23" tabindex="-1"></a>fcpp<span class="ot">&lt;-</span><span class="fu">fd</span>(result[,<span class="dv">1</span>],result[,<span class="dv">2</span>])</span></code></pre></div>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a>Gibbsr<span class="ot">&lt;-</span><span class="cf">function</span>(){</span>
<span id="cb134-2"><a href="#cb134-2" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb134-3"><a href="#cb134-3" tabindex="-1"></a>  </span>
<span id="cb134-4"><a href="#cb134-4" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb134-5"><a href="#cb134-5" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="dv">50</span></span>
<span id="cb134-6"><a href="#cb134-6" tabindex="-1"></a>  X[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(x,y)</span>
<span id="cb134-7"><a href="#cb134-7" tabindex="-1"></a>  </span>
<span id="cb134-8"><a href="#cb134-8" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb134-9"><a href="#cb134-9" tabindex="-1"></a>    x2<span class="ot">&lt;-</span>X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb134-10"><a href="#cb134-10" tabindex="-1"></a>    X[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">100</span>,x2)</span>
<span id="cb134-11"><a href="#cb134-11" tabindex="-1"></a>    x1<span class="ot">&lt;-</span>X[i<span class="dv">-1</span>,<span class="dv">1</span>]</span>
<span id="cb134-12"><a href="#cb134-12" tabindex="-1"></a>    X[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,x1<span class="sc">+</span>a,n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb134-13"><a href="#cb134-13" tabindex="-1"></a>  }</span>
<span id="cb134-14"><a href="#cb134-14" tabindex="-1"></a>  b<span class="ot">&lt;-</span>burn<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb134-15"><a href="#cb134-15" tabindex="-1"></a>  x<span class="ot">&lt;-</span>X[b<span class="sc">:</span>N,] </span>
<span id="cb134-16"><a href="#cb134-16" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb134-17"><a href="#cb134-17" tabindex="-1"></a>}</span>
<span id="cb134-18"><a href="#cb134-18" tabindex="-1"></a></span>
<span id="cb134-19"><a href="#cb134-19" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">Gibbsr</span>()</span>
<span id="cb134-20"><a href="#cb134-20" tabindex="-1"></a>fr<span class="ot">&lt;-</span><span class="fu">fd</span>(x[,<span class="dv">1</span>],x[,<span class="dv">2</span>])</span></code></pre></div>
<p>Considering that the obtained data values are relatively small, take
the logarithm to create a QQ chart</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a><span class="fu">qqplot</span>(<span class="fu">log</span>(fcpp),<span class="fu">log</span>(fr))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a>ts<span class="ot">&lt;-</span><span class="fu">microbenchmark</span>(<span class="at">timecpp=</span><span class="fu">Gibbs</span>(N, burn, n, a, b),<span class="at">timer=</span><span class="fu">Gibbsr</span>())</span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##      expr        lq    median        uq
## 1 timecpp  2.395401  2.430801  2.536151
## 2   timer 24.487651 26.267451 28.993550</code></pre>
<p>Rcpp is faster and more efficient in solving the 9.8 problem compared
to R.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
